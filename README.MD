MegaVote Enquetes 

MegaVote Enquetes Ã© um app leve para criaÃ§Ã£o e conduÃ§Ã£o de enquetes condominiais, com acesso pÃºblico por link seguro para participantes e painel administrativo completo para sÃ­ndicos/gestores. O projeto tambÃ©m foi pensado como hub, permitindo plugar outros mÃ³dulos â€” como o Sorteio de Vagas â€” reaproveitando a mesma autenticaÃ§Ã£o de administradores.

âœ¨ Principais recursos
MÃ³dulo Enquetes (admin)

CriaÃ§Ã£o de â€œsalasâ€ de enquete com tÃ­tulo e data.

Link pÃºblico com token aleatÃ³rio (ativar/desativar/regenerar).

Pautas para ordenaÃ§Ã£o e ediÃ§Ã£o.

Enquetes por pautas, com:

MÃºltipla ou Ãºnica escolha (max_choices).

Ativar/pausar votaÃ§Ã£o (toggle).

â€œLiberar resultado ao pÃºblicoâ€ (apresenta grÃ¡fico em tempo real).

OrdenaÃ§Ã£o de enquetes por item (â†‘/â†“).

Resultado por enquete e por item (grÃ¡ficos + exportaÃ§Ã£o em PDF).

Contador de participantes da sala (modelo â€œparticipante pÃºblicoâ€).

Acesso PÃºblico (participantes)

Entrada por link pÃºblico (/public/join.php?token=...).

â€œCadastro leveâ€ para a sala especÃ­fica: nome, e-mail, condomÃ­nio, bloco e unidade.

SessÃ£o de participante escopada por sala: o mesmo convidado entra direto caso jÃ¡ tenha se identificado.

VotaÃ§Ãµes:

SÃ³ aparecem enquetes ativas ou com resultado liberado.

Respeita limite de escolhas, evita voto duplicado, registra IP e anulaÃ§Ãµes.

SeguranÃ§a

Cookie de sessÃ£o com flags seguras (HttpOnly, SameSite, Secure quando HTTPS).

RegeneraÃ§Ã£o de ID ao login e metadados de sessÃ£o (criada em, last activity).

Timeout de inatividade e TTL absoluto (configurÃ¡veis) + â€œfingerprintâ€ leve (UA+IP parcial).

Guardas de rota:

enforceSessionGuard('admin') para admin.

SessÃ£o â€œbasicâ€ escopada por enquete para participantes.

CSRF preparado (em vÃ¡rias telas) e fÃ¡cil de ativar globalmente.

ApÃ³s login de admin, exibir um Hub com cards:

Enquetes

Sorteio de Vagas

ğŸ§­ Fluxo resumido

Admin

Faz login ou herda login CondoHuby (usuÃ¡rio/senha).

Cria uma sala e suas pautas/itens.

Cria enquetes dentro das pautas e ativa quando quiser.

Ativa o link pÃºblico e compartilha com os moradores.

Acompanha resultados em tempo real; pode encerrar votaÃ§Ã£o e exportar PDF.

Participante (morador)

Acessa o link pÃºblico.

Preenche identificaÃ§Ã£o rÃ¡pida (nome, e-mail, condomÃ­nio, bloco, unidade).

Entra direto na lista de pautas e vota nas enquetes ativas.

Pode visualizar resultados se liberados.

ğŸ§± Modelo de dados (resumo)

A estrutura completa (DDL) estÃ¡ no schema.sql. Abaixo, uma visÃ£o por alto:

users: admins do sistema (master/admin).

assembleias: salas com token pÃºblico e flags de link.

itens: pautas numeradas de uma assembleia.

polls: enquetes ligadas a um item, com flags is_active e show_results.

options: alternativas de cada enquete.

votes: votos (com is_annulled, IP, timestamps).

participants: novo cadastro leve por sala (nome, e-mail, bloco, etc.). Substitui o antigo inscritos no papel de identificar participantes no link pÃºblico.

ğŸ—‚ï¸ Estrutura de pastas (sugerida)
poll-app/
â”œâ”€ admin/               # telas do admin (painÃ©is, CRUDs)
â”œâ”€ auth/                # login, logout, session_timeout
â”œâ”€ vote/                # telas do participante logado (pautas, enquetes)
â”œâ”€ public/              # join.php + fluxo pÃºblico de entrada
â”œâ”€ raffle/              # (opcional) mÃ³dulo Sorteio de Vagas integrado ao hub
â”œâ”€ layout/              # header.php / footer.php / assets comuns
â”œâ”€ config/
â”‚  â””â”€ db.php            # conexÃ£o PDO
â”œâ”€ schema/
â”‚  â””â”€ schema.sql        # DDL completa
â”œâ”€ docker/              # Dockerfile(s) e compose
â””â”€ index.php            # redireciona pro login/hub conforme sessÃ£o

ğŸ”— Link pÃºblico (participantes)

Criar sala âœ admin habilita link em painel_admin/manage_itens.

O link Ã© do tipo:
https://dominio/public/join.php?token=<invite_token>

O participante nÃ£o cria conta no sistema; ele se identifica na sala e recebe sessÃ£o â€œbasicâ€ escopada Ã  sala.